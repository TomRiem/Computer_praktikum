\chapter{Numerics}

In this section the implementation of a practical RBFGS method as a function in the programming language Julia (\url{https://julialang.org}) is presented and its numerical behavior is tested by suitable optimization problems. Julia is a high-performance, dynamic programming language, its features are well-suited for numerical analysis and computational science and it has a built-in package manager. The RBFGS method (and variants thereof) presented here is implemented in the package \lstinline!Manopt.jl! (available at \url{https://manoptjl.org}, \cite{Bergmann:2019}), which provides a framework for optimization on manifolds and follows the same philosophy as the \textsc{Matlab} version (available at \url{https://www.manopt.org/}, see also \cite{BoumalMishraAbsilSepulchre:2014}). \lstinline!Manopt.jl! provides an easy access to optimization methods on manifolds for Julia, including example data and visualization methods. This project is build upon \lstinline!ManifoldsBase.jl! (available at \url{https://github.com/JuliaManifolds/ManifoldsBase.jl}), a generic interface to implement manifolds. Certain functions are extended for specific manifolds from the package \lstinline!Manifolds.jl! (available at \url{https://juliamanifolds.github.io/Manifolds.jl}), which aims to provide a library of manifolds to be used within the project. The implemented manifolds are accompanied by their mathematical formulae. \\

There are various approaches for implementing a numerical method, all of them focus on different properties and aspects of a function that can be applied in practice. Qi named the following aspects in her dissertation \cite{Qi:2011}, which are important for the practical implementation of an RBFGS method:
\begin{enumerate}
    \item An efficient numerical representation for points $x$ on $\mathcal{M}$, tangent vectors $\xi_x \in \tangent{x}$ and the inner products $g_x(\xi_x, \eta_x)$ on $\tangent{x}$.
    \item An implementation of the chosen retraction $\retract{x} \colon \; \tangent{x} \to \mathcal{M}$.
    \item Efficient formulae for $f(\cdot)$ and $\operatorname{grad} f(\cdot)$.
    \item An implementation of the chosen vector transport $\vectorTransportSymbol$.
    \item A method for solving $\mathcal{H}^{RBFGS}_{k} [\eta_k] = -\operatorname{grad} f(x_k)$ or alternatively, a method for computing $\eta_k = -\mathcal{B}^{RBFGS}_{k} [\operatorname{grad} f(x_k)]$. 
\end{enumerate}
Methods for the first four points are provided by the packages \lstinline!Manopt.jl!, \lstinline!Manifolds.jl! and \lstinline!ManifoldsBase.jl!. The main focus of this section is therefore on a practical and efficient implementation of the update formula \cref{RiemannianInverseBFGSFormula} for the operator $\mathcal{B}^{RBFGS}_{k}$, so that the search direction $\eta_k$ can be calculated in each iteration by simply applying the operator $\mathcal{B}^{RBFGS}_{k}$ to the gradient $\operatorname{grad} f(x_k) \in \tangent{x_k}$ and thus the method runs stable and finds the minimum of the given minimization problem as quickly as possible. \\
It should be noted that only the implementation of \cref{RiemannianInverseBFGSFormula} is considered, as used in \cref{InverseGlobalRiemannianBFGS-Method}, \cref{InverseGlobalRiemannianBFGS-MethodLockingCondition} and \cref{CautiousRBFGSMethod}.

\input{Chapter4/RealizingTheUpdate-Formula.tex}
\input{Chapter4/Experiments.tex}